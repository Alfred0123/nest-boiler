apiVersion: skaffold/v2beta16
kind: Config
metadata:
  name: skaffold
.YamlAnchors:
  artifactDefinitions:
    - &api
      name: api
      chartPath: ../charts/api
      valuesFiles:
        - ./commonValues.yaml
        - ./api/values.yaml
      artifactOverrides:
        image: keke0123/nest-boiler-dev
      imageStrategy:
        helm: {}
profiles:
  - name: api
    build:
      tagPolicy:
        # envTemplate:
        #   template: latest
        gitCommit:
          ignoreChanges: false
      artifacts:
        - image: keke0123/nest-boiler-dev
          context: "../../../api"
          docker:
            dockerfile: "Dockerfile.dev"
            cacheFrom:
              - keke0123/nest-boiler-dev
            buildArgs:
              TARGET_ENV: local
          sync:
            manual:
              - src: "../../../api/*"
                dest: "/usr/src/app"
    deploy:
      helm:
        releases:
          - *api
